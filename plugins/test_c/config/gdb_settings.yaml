---

commands:
    load_file:
        steps:
            - run_command:
                command: 'file tests/binaries/c_test/c_test'
    info_source:
        steps:
            - run_command:
                command: 'list'
            - run_command_with_match:
                command: 'info source'
                match: 'Located in (.*)\"$'
                match_group: 1
                try_set: 'current_filename'
            - print_debug:
                msg: "current_filename: {{ current_filename }}"
            - set_buffer:
                buffer_name: 'vg_code'
                file_name: "{{ current_filename }}"

variables:
    current_filename: ''

events:
    after_startup:
        - 'load_file'

buffers:
    vg_session_log:
        on_startup: true
    vg_code:
        on_startup: true
        primary_window: true
        language: 'c'

settings:
    process:
        ttl_stream_timeout: 0.08
        main_process_name: 'gdb'
        main_process_default_arguments: ' -q --interpreter=mi2 '
        end_of_output_regex: '\(gdb\)'
